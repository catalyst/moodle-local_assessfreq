{"version":3,"file":"activities_in_progress.min.js","sources":["../src/activities_in_progress.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Chart data JS module.\n *\n * @module     assessfreqreport/activities_in_progress\n * @package\n * @copyright  Simon Thornett <simon.thornett@catalyst-eu.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport TableHandler from 'local_assessfreq/table_handler';\nimport * as UserPreference from 'local_assessfreq/user_preferences';\n\n/**\n * Init function.\n * @param {Integer} context\n */\nexport const init = (context) => {\n\n    // Set up event listener and related actions for module dropdown on heatmp.\n    moduleDropdown();\n\n    let table = new TableHandler(\n        0,\n        context,\n        'assessfreqreport-activities-in-progress-table',\n        'assessfreqreport_activities_in_progress',\n        'get_in_progress_table',\n        'assessfreqreport_activities_in_progress_table_rows_preference',\n        'assessfreqreport_activities_in_progress_table_sort_preference',\n        'assessfreqreport-activities-in-progress-table-search',\n        'assessfreqreport-activities-in-progress-table',\n        'local_assessfreq_set_table_preference'\n    );\n\n    table.getTable();\n\n    let tableSearchInputElement = document.getElementById('assessfreqreport-activities-in-progress-table-search');\n    let tableSearchResetElement = document.getElementById('assessfreqreport-activities-in-progress-table-search-reset');\n    let tableSearchRowsElement = document.getElementById('assessfreqreport-activities-in-progress-table-rows');\n    let tableSearchAheadElement = document.getElementById('assessfreqreport-activities-in-progress-hoursahead');\n    let tableSearchBehindElement = document.getElementById('assessfreqreport-activities-in-progress-hoursbehind');\n\n    tableSearchInputElement.addEventListener('keyup', table.tableSearch);\n    tableSearchInputElement.addEventListener('paste', table.tableSearch);\n    tableSearchResetElement.addEventListener('click', table.tableSearchReset);\n    tableSearchRowsElement.addEventListener('click', table.tableSearchRowSet);\n    tableSearchAheadElement.addEventListener('click', tableSearchAheadSet);\n    tableSearchBehindElement.addEventListener('click', tableSearchBehindSet);\n\n};\n\n/**\n * Add the event listeners to the modules in the module select dropdown.\n */\nconst moduleDropdown = () => {\n    let links = document.getElementById('local-assessfreq-report-activities-in-progress-filter-type').getElementsByTagName('a');\n    let all = links[0];\n    let modules = [];\n\n    for (let i = 0; i < links.length; i++) {\n        let module = links[i].dataset.module;\n\n        if (module.toLowerCase() === 'all') {\n            links[i].addEventListener('click', event => {\n                event.preventDefault();\n                event.stopPropagation();\n                // Remove active class from all other links.\n                for (let j = 0; j < links.length; j++) {\n                    links[j].classList.remove('active');\n                }\n                event.target.classList.toggle('active');\n            });\n        } else if (module.toLowerCase() === 'close') {\n            links[i].addEventListener('click', event => {\n                event.preventDefault();\n                event.stopPropagation();\n\n                const dropdownmenu = document.getElementById('local-assessfreq-report-activities-in-progress-filter-type-filters');\n                dropdownmenu.classList.remove('show');\n\n                for (let i = 0; i < links.length; i++) {\n                    if (links[i].classList.contains('active')) {\n                        let module = links[i].dataset.module;\n                        modules.push(module);\n                    }\n                }\n\n                // Save selection as a user preference.\n                UserPreference.setUserPreference(\n                    'assessfreqreport_activities_in_progress_modules_preference',\n                    JSON.stringify(modules)\n                );\n\n                // Reload based on selected year.\n                location.reload();\n            });\n        } else {\n            links[i].addEventListener('click', event => {\n                event.preventDefault();\n                event.stopPropagation();\n\n                all.classList.remove('active');\n\n                event.target.classList.toggle('active');\n            });\n        }\n    }\n};\n\n/**\n * Process the hours ahead event from the student table.\n *\n * @param {Event} event The triggered event for the element.\n */\nconst tableSearchAheadSet = (event) => {\n    event.preventDefault();\n    if (event.target.tagName.toLowerCase() === 'a') {\n        let hours = event.target.dataset.metric;\n        UserPreference.setUserPreference('assessfreqreport_activities_in_progress_hoursahead_preference', hours);\n        // Reload based on selected year.\n        location.reload();\n    }\n};\n\n/**\n * Process the hours behind event from the student table.\n *\n * @param {Event} event The triggered event for the element.\n */\nconst tableSearchBehindSet = (event) => {\n    event.preventDefault();\n    if (event.target.tagName.toLowerCase() === 'a') {\n        let hours = event.target.dataset.metric;\n        UserPreference.setUserPreference('assessfreqreport_activities_in_progress_hoursbehind_preference', hours);\n        // Reload based on selected year.\n        location.reload();\n    }\n};\n"],"names":["context","moduleDropdown","table","TableHandler","getTable","tableSearchInputElement","document","getElementById","tableSearchResetElement","tableSearchRowsElement","tableSearchAheadElement","tableSearchBehindElement","addEventListener","tableSearch","tableSearchReset","tableSearchRowSet","tableSearchAheadSet","tableSearchBehindSet","links","getElementsByTagName","all","modules","i","length","module","dataset","toLowerCase","event","preventDefault","stopPropagation","j","classList","remove","target","toggle","contains","push","UserPreference","setUserPreference","JSON","stringify","location","reload","tagName","hours","metric"],"mappings":";;;;;;;;qmCA+BqBA,UAGjBC,qBAEIC,MAAQ,IAAIC,uBACZ,EACAH,QACA,gDACA,0CACA,wBACA,gEACA,gEACA,uDACA,gDACA,yCAGJE,MAAME,eAEFC,wBAA0BC,SAASC,eAAe,wDAClDC,wBAA0BF,SAASC,eAAe,8DAClDE,uBAAyBH,SAASC,eAAe,sDACjDG,wBAA0BJ,SAASC,eAAe,sDAClDI,yBAA2BL,SAASC,eAAe,uDAEvDF,wBAAwBO,iBAAiB,QAASV,MAAMW,aACxDR,wBAAwBO,iBAAiB,QAASV,MAAMW,aACxDL,wBAAwBI,iBAAiB,QAASV,MAAMY,kBACxDL,uBAAuBG,iBAAiB,QAASV,MAAMa,mBACvDL,wBAAwBE,iBAAiB,QAASI,qBAClDL,yBAAyBC,iBAAiB,QAASK,6BAOjDhB,eAAiB,SACfiB,MAAQZ,SAASC,eAAe,8DAA8DY,qBAAqB,KACnHC,IAAMF,MAAM,GACZG,QAAU,OAET,IAAIC,EAAI,EAAGA,EAAIJ,MAAMK,OAAQD,IAAK,KAC/BE,OAASN,MAAMI,GAAGG,QAAQD,OAED,QAAzBA,OAAOE,cACPR,MAAMI,GAAGV,iBAAiB,SAASe,QAC/BA,MAAMC,iBACND,MAAME,sBAED,IAAIC,EAAI,EAAGA,EAAIZ,MAAMK,OAAQO,IAC9BZ,MAAMY,GAAGC,UAAUC,OAAO,UAE9BL,MAAMM,OAAOF,UAAUG,OAAO,aAEF,UAAzBV,OAAOE,cACdR,MAAMI,GAAGV,iBAAiB,SAASe,QAC/BA,MAAMC,iBACND,MAAME,kBAEevB,SAASC,eAAe,sEAChCwB,UAAUC,OAAO,YAEzB,IAAIV,EAAI,EAAGA,EAAIJ,MAAMK,OAAQD,OAC1BJ,MAAMI,GAAGS,UAAUI,SAAS,UAAW,KACnCX,OAASN,MAAMI,GAAGG,QAAQD,OAC9BH,QAAQe,KAAKZ,QAKrBa,eAAeC,kBACX,6DACAC,KAAKC,UAAUnB,UAInBoB,SAASC,YAGbxB,MAAMI,GAAGV,iBAAiB,SAASe,QAC/BA,MAAMC,iBACND,MAAME,kBAENT,IAAIW,UAAUC,OAAO,UAErBL,MAAMM,OAAOF,UAAUG,OAAO,eAWxClB,oBAAuBW,WACzBA,MAAMC,iBACqC,MAAvCD,MAAMM,OAAOU,QAAQjB,cAAuB,KACxCkB,MAAQjB,MAAMM,OAAOR,QAAQoB,OACjCR,eAAeC,kBAAkB,gEAAiEM,OAElGH,SAASC,WASXzB,qBAAwBU,WAC1BA,MAAMC,iBACqC,MAAvCD,MAAMM,OAAOU,QAAQjB,cAAuB,KACxCkB,MAAQjB,MAAMM,OAAOR,QAAQoB,OACjCR,eAAeC,kBAAkB,iEAAkEM,OAEnGH,SAASC"}