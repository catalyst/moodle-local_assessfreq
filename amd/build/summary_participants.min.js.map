{"version":3,"file":"summary_participants.min.js","sources":["../src/summary_participants.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for summary participants graph.\n *\n * @package    local_assessfreq\n * @copyright  2020 Matt Porritt <mattp@catalyst-au.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(\n    ['core/fragment', 'core/templates', 'core/str', 'core/notification'],\n    function (Fragment, Templates, Str, Notification) {\n\n        /**\n         * Module level variables.\n         */\n        var Summary = {};\n\n        Summary.chart = function (assessids, contextid) {\n            assessids.forEach((assessid) => {\n                let chartElement = document.getElementById(assessid + '-summary-graph');\n                let params = {'data': JSON.stringify({'quiz' : assessid, 'call': 'participant_summary'})};\n\n                Fragment.loadFragment('local_assessfreq', 'get_quiz_chart', contextid, params)\n                .done((response) => {\n                    let resObj = JSON.parse(response);\n                    if (resObj.hasdata == true) {\n                        let legend = {position: 'left'};\n                        let context = {\n                            'withtable' : false,\n                            'chartdata' : JSON.stringify(resObj.chart),\n                            'aspect' : false,\n                            'legend' : JSON.stringify(legend)\n                        };\n                        Templates.render('local_assessfreq/chart', context).done((html, js) => {\n                            // Load card body.\n                            Templates.replaceNodeContents(chartElement, html, js);\n                        }).fail(() => {\n                            Notification.exception(new Error('Failed to load chart template.'));\n                            return;\n                        });\n                        return;\n                    } else {\n                        Str.get_string('nodata', 'local_assessfreq').then((str) => {\n                            const noDatastr = document.createElement('h3');\n                            noDatastr.innerHTML = str;\n                            chartElement.innerHTML = noDatastr.outerHTML;\n                            return;\n                        }).catch(() => {\n                            Notification.exception(new Error('Failed to load string: nodata'));\n                        });\n                    }\n                }).fail(() => {\n                    Notification.exception(new Error('Failed to load card.'));\n                    return;\n                });\n            });\n        };\n\n        return Summary;\n    }\n);\n"],"names":["define","Fragment","Templates","Str","Notification","Summary","assessids","contextid","forEach","assessid","chartElement","document","getElementById","params","JSON","stringify","loadFragment","done","response","resObj","parse","hasdata","get_string","then","str","noDatastr","createElement","innerHTML","outerHTML","catch","exception","Error","legend","position","context","chart","render","html","js","replaceNodeContents","fail"],"mappings":";;;;;;;AAuBAA,+CACI,CAAC,gBAAiB,iBAAkB,WAAY,sBAChD,SAAUC,SAAUC,UAAWC,IAAKC,kBAK5BC,QAAU,CAEdA,MAAgB,SAAUC,UAAWC,WACjCD,UAAUE,SAASC,eACXC,aAAeC,SAASC,eAAeH,SAAW,kBAClDI,OAAS,MAASC,KAAKC,UAAU,MAAUN,cAAkB,yBAEjER,SAASe,aAAa,mBAAoB,iBAAkBT,UAAWM,QACtEI,MAAMC,eACCC,OAASL,KAAKM,MAAMF,aACF,GAAlBC,OAAOE,QAiBPlB,IAAImB,WAAW,SAAU,oBAAoBC,MAAMC,YACzCC,UAAYd,SAASe,cAAc,MACzCD,UAAUE,UAAYH,IACtBd,aAAaiB,UAAYF,UAAUG,aAEpCC,OAAM,KACLzB,aAAa0B,UAAU,IAAIC,MAAM,8CAtBjCC,OAAS,CAACC,SAAU,QACpBC,QAAU,YACI,YACApB,KAAKC,UAAUI,OAAOgB,eACzB,SACArB,KAAKC,UAAUiB,SAE9B9B,UAAUkC,OAAO,yBAA0BF,SAASjB,MAAK,CAACoB,KAAMC,MAE5DpC,UAAUqC,oBAAoB7B,aAAc2B,KAAMC,OACnDE,MAAK,KACJpC,aAAa0B,UAAU,IAAIC,MAAM,0CAc1CS,MAAK,KACJpC,aAAa0B,UAAU,IAAIC,MAAM,wCAMtC1B"}